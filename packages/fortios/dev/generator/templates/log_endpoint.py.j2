"""
FortiOS LOG API - {{ class_name }}

Log query endpoints for {{ subcategory }} logs.

Note: LOG endpoints are read-only (GET only) and return log data.
They use nested classes to represent path parameters.

Example Usage:
{% for example in examples %}
    >>> {{ example }}
{% endfor %}
"""

from __future__ import annotations

from typing import TYPE_CHECKING, Any

if TYPE_CHECKING:
    from hfortix_core.http.interface import IHTTPClient

from hfortix_fortios.models import FortiObjectList


class {{ class_name }}:
    """{{ class_name }} log operations.
    
    Provides access to {{ subcategory }} log endpoints with nested classes
    for different log types and subtypes.
    """

    def __init__(self, client: "IHTTPClient"):
        """Initialize {{ class_name }} endpoint."""
        self._client = client
{% for attr in attributes %}
        self.{{ attr.name }} = {{ attr.class_name }}(client)
{% endfor %}

{% for endpoint_class in endpoint_classes %}

class {{ endpoint_class.class_name }}:
    """{{ endpoint_class.docstring }}"""

    def __init__(self, client: "IHTTPClient"{{ ', ' + endpoint_class.init_params if endpoint_class.init_params else '' }}):
        """Initialize {{ endpoint_class.class_name }}."""
        self._client = client
{% for param in endpoint_class.stored_params %}
        self._{{ param.name }} = {{ param.value }}
{% endfor %}
{% for attr in endpoint_class.attributes %}
        self.{{ attr.name }} = {{ attr.class_name }}(client{{ ', ' + attr.init_args if attr.init_args else '' }})
{% endfor %}
{% if endpoint_class.has_get %}

    def get(
        self,
        *,
        rows: int | None = None,
        session_id: int | None = None,
        serial_no: str | None = None,
        is_ha_member: bool | None = None,
        filter: str | None = None,
        extra: str | None = None,
        vdom: str | None = None,
    ) -> FortiObjectList:
        """
        Get {{ endpoint_class.log_type }} logs.

        Args:
            rows: Number of rows to return (default: server decides)
            session_id: Session ID for paginated retrieval (from previous response)
            serial_no: Retrieve logs from specific device serial number
            is_ha_member: Whether the device is an HA member
            filter: Filter expression (e.g., "srcip==192.168.1.1")
            extra: Extra data flags [reverse_lookup|country_id]
            vdom: Virtual domain (if not using default)

        Returns:
            FortiObjectList containing log records with metadata

        Example:
            >>> logs = fgt.api.log.{{ subcategory }}.{{ endpoint_class.example_path }}.get(rows=100)
            >>> for log in logs:
            ...     print(log.srcip, log.dstip)
        """
        params: dict[str, Any] = {}
        if rows is not None:
            params["rows"] = rows
        if session_id is not None:
            params["session_id"] = session_id
        if serial_no is not None:
            params["serial_no"] = serial_no
        if is_ha_member is not None:
            params["is_ha_member"] = is_ha_member
        if filter is not None:
            params["filter"] = filter
        if extra is not None:
            params["extra"] = extra
        if vdom is not None:
            params["vdom"] = vdom

        result = self._client.get("log", "{{ endpoint_class.api_path }}", params=params if params else None)
        return result
{% endif %}
{% endfor %}
