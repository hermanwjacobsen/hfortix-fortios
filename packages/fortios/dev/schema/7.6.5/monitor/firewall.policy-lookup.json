{
  "schema_version": "1.7.4",
  "generated_at": "2026-01-27T21:24:04.573006+00:00",
  "generator_version": "1.7.4",
  "path": "firewall/policy-lookup",
  "module": "firewall",
  "name": "policy-lookup",
  "full_path": "firewall/policy-lookup",
  "class_name": "FirewallPolicyLookup",
  "pydantic_class_name": "FirewallPolicyLookup",
  "python_module": "hfortix_fortios.api.v2.monitor.firewall.policy_lookup",
  "python_import": "from hfortix_fortios.api.v2.monitor.firewall.policy_lookup import FirewallPolicyLookup",
  "api_type": "monitor",
  "swagger_source": "swagger/7.6.5/monitor/firewall.json",
  "http_methods": [
    "GET"
  ],
  "operations": {
    "collection": [
      "GET"
    ],
    "item": []
  },
  "has_mkey": false,
  "query_params": {
    "GET": {
      "ipv6": {
        "type": "boolean",
        "required": false,
        "description": "Perform an IPv6 lookup?"
      },
      "srcintf": {
        "type": "string",
        "required": true,
        "description": "Source interface."
      },
      "sourceport": {
        "type": "integer",
        "required": false,
        "description": "Source port."
      },
      "sourceip": {
        "type": "string",
        "required": true,
        "description": "Source IP."
      },
      "protocol": {
        "type": "string",
        "required": true,
        "description": "Protocol."
      },
      "dest": {
        "type": "string",
        "required": true,
        "description": "Destination IP/FQDN."
      },
      "destport": {
        "type": "integer",
        "required": false,
        "description": "Destination port."
      },
      "icmptype": {
        "type": "integer",
        "required": false,
        "description": "ICMP type."
      },
      "icmpcode": {
        "type": "integer",
        "required": false,
        "description": "ICMP code."
      },
      "policy_type": {
        "type": "string",
        "required": false,
        "description": "Policy type. [*policy | proxy]"
      },
      "auth_type": {
        "type": "string",
        "required": false,
        "description": "Authentication type. [user | group | saml | ldap] Note: this only works for models that can guarantee WAD workers availability, i.e. those that do not disable proxy features globally."
      },
      "user_group": {
        "type": "array",
        "required": false,
        "description": "List of remote user groups. ['cn=remote desktop users,cn=builtin,dc=devqa,dc=lab','cn=domain users,cn=users,dc=devqa,dc=lab', ...] Note: this only works for models that can guarantee WAD workers availability, i.e. those that do not disable proxy features globally."
      },
      "server_name": {
        "type": "string",
        "required": false,
        "description": "Remote user/group server name. Note: this only works for models that can guarantee WAD workers availability, i.e. those that do not disable proxy features globally."
      },
      "user_db": {
        "type": "string",
        "required": false,
        "description": "Authentication server to contain user information."
      },
      "group_attr_type": {
        "type": "string",
        "required": false,
        "description": "Remote user group attribute type. [*name | id]"
      }
    }
  },
  "operation_details": {
    "GET": {
      "summary": "Performs a policy lookup by creating a dummy packet and asking the kernel which policy would be hit.\nAccess Group: fwgrp.policy",
      "description": ""
    }
  },
  "access_group": "fwgrp.policy",
  "help": "Performs a policy lookup by creating a dummy packet and asking the kernel which policy would be hit.",
  "supported": true,
  "readonly": false,
  "action": "select",
  "category": "action_select",
  "response_fields": {
    "dstaddr": {
      "name": "dstaddr",
      "type": "string",
      "python_name": "dstaddr",
      "title": "Destination Address",
      "description": "The address for the destination.",
      "pydantic_type": "str",
      "python_type": "str"
    },
    "dst_cate": {
      "name": "dst_cate",
      "type": "integer",
      "python_name": "dst_cate",
      "title": "Destination Category",
      "description": "Proxy destination category.",
      "pydantic_type": "int",
      "python_type": "int"
    },
    "match": {
      "name": "match",
      "type": "boolean",
      "python_name": "match",
      "title": "Policy Match",
      "description": "True when a policy is matched during the policy lookup.",
      "pydantic_type": "bool",
      "python_type": "bool"
    },
    "matched_policy_type": {
      "name": "matched_policy_type",
      "type": "string",
      "python_name": "matched_policy_type",
      "title": "Policy Type",
      "description": "The type of firewall policy can either be a regular policy or a proxy policy.",
      "pydantic_type": "Literal['policy', 'proxy-policy']",
      "python_type": "str",
      "validation": {
        "allowed_values": [
          "policy",
          "proxy-policy"
        ]
      },
      "enum_labels": [
        {
          "name": "policy",
          "label": "Policy"
        },
        {
          "name": "proxy-policy",
          "label": "Proxy Policy"
        }
      ]
    },
    "policy_action": {
      "name": "policy_action",
      "type": "string",
      "python_name": "policy_action",
      "title": "Policy Action",
      "description": "The action for the matching policy.",
      "pydantic_type": "Literal['deny', 'accept', 'ipsec', 'redirect', 'unknown']",
      "python_type": "str",
      "validation": {
        "allowed_values": [
          "deny",
          "accept",
          "ipsec",
          "redirect",
          "unknown"
        ]
      },
      "enum_labels": [
        {
          "name": "deny",
          "label": "Deny"
        },
        {
          "name": "accept",
          "label": "Accept"
        },
        {
          "name": "ipsec",
          "label": "Ipsec"
        },
        {
          "name": "redirect",
          "label": "Redirect"
        },
        {
          "name": "unknown",
          "label": "Unknown"
        }
      ]
    },
    "policy_id": {
      "name": "policy_id",
      "type": "integer",
      "python_name": "policy_id",
      "title": "Policy ID",
      "description": "The ID for the policy.",
      "pydantic_type": "int",
      "python_type": "int"
    },
    "proxy_policy_id": {
      "name": "proxy_policy_id",
      "type": "integer",
      "python_name": "proxy_policy_id",
      "title": "Proxy Policy ID",
      "description": "The ID for the proxy policy.",
      "pydantic_type": "int",
      "python_type": "int"
    },
    "remote_groups": {
      "name": "remote_groups",
      "type": "array",
      "python_name": "remote_groups",
      "title": "Remote Groups",
      "description": "The remote groups that that the policy matches.",
      "pydantic_type": "List[str]",
      "python_type": "list"
    },
    "sec_default_action": {
      "name": "sec_default_action",
      "type": "string",
      "python_name": "sec_default_action",
      "title": "Default Firewall Policy Action",
      "description": "Default action for firewall policy.",
      "pydantic_type": "Literal['allow', 'deny']",
      "python_type": "str",
      "validation": {
        "allowed_values": [
          "allow",
          "deny"
        ]
      },
      "enum_labels": [
        {
          "name": "allow",
          "label": "Allow"
        },
        {
          "name": "deny",
          "label": "Deny"
        }
      ]
    },
    "srcaddr": {
      "name": "srcaddr",
      "type": "string",
      "python_name": "srcaddr",
      "title": "Source Address",
      "description": "The address for the source.",
      "pydantic_type": "str",
      "python_type": "str"
    },
    "success": {
      "name": "success",
      "type": "boolean",
      "python_name": "success",
      "title": "Lookup Successful",
      "description": "True when a lookup was successful.",
      "pydantic_type": "bool",
      "python_type": "bool"
    },
    "urlf_entry_id": {
      "name": "urlf_entry_id",
      "type": "integer",
      "python_name": "urlf_entry_id",
      "title": "Static Web Filter URL Entry ID",
      "description": "The matching static URL filter entry ID.",
      "pydantic_type": "int",
      "python_type": "int"
    },
    "user_group": {
      "name": "user_group",
      "type": "string",
      "python_name": "user_group",
      "title": "The Local User or Group",
      "description": "The matching local user or group name for the policy.",
      "pydantic_type": "str",
      "python_type": "str"
    },
    "webfilter_action": {
      "name": "webfilter_action",
      "type": "string",
      "python_name": "webfilter_action",
      "title": "Web Filter Action",
      "description": "The matching FortiGuard category filter action.",
      "pydantic_type": "Literal['allow', 'deny', 'ovrd', 'warn', 'redir', 'block_http_response', 'unknown']",
      "python_type": "str",
      "validation": {
        "allowed_values": [
          "allow",
          "deny",
          "ovrd",
          "warn",
          "redir",
          "block_http_response",
          "unknown"
        ]
      },
      "enum_labels": [
        {
          "name": "allow",
          "label": "Allow"
        },
        {
          "name": "deny",
          "label": "Deny"
        },
        {
          "name": "ovrd",
          "label": "Ovrd"
        },
        {
          "name": "warn",
          "label": "Warn"
        },
        {
          "name": "redir",
          "label": "Redir"
        },
        {
          "name": "block_http_response",
          "label": "Block Http Response"
        },
        {
          "name": "unknown",
          "label": "Unknown"
        }
      ]
    },
    "webfilter_category": {
      "name": "webfilter_category",
      "type": "integer",
      "python_name": "webfilter_category",
      "title": "Web Filter Category ID",
      "description": "The matching FortiGuard category filter ID.",
      "pydantic_type": "int",
      "python_type": "int"
    },
    "webfilter_profile": {
      "name": "webfilter_profile",
      "type": "string",
      "python_name": "webfilter_profile",
      "title": "Web Filter Profile Name",
      "description": "The matching category filter profile name.",
      "pydantic_type": "str",
      "python_type": "str"
    },
    "error_code": {
      "name": "error_code",
      "type": "string",
      "python_name": "error_code",
      "title": "Policy Lookup Error Code",
      "description": "Error code for when policy lookup fails.",
      "pydantic_type": "Literal['error_invalid_request', 'error_unresolved_dns', 'error_invalid_user', 'error_inactive_proxy', 'error_unknown_source_route', 'error_unknown_route', 'error_internal', 'error_invalid_server', 'error_invalid_scim_client', 'error_authentication_failed']",
      "python_type": "str",
      "validation": {
        "allowed_values": [
          "error_invalid_request",
          "error_unresolved_dns",
          "error_invalid_user",
          "error_inactive_proxy",
          "error_unknown_source_route",
          "error_unknown_route",
          "error_internal",
          "error_invalid_server",
          "error_invalid_scim_client",
          "error_authentication_failed"
        ]
      },
      "enum_labels": [
        {
          "name": "error_invalid_request",
          "label": "Error Invalid Request"
        },
        {
          "name": "error_unresolved_dns",
          "label": "Error Unresolved Dns"
        },
        {
          "name": "error_invalid_user",
          "label": "Error Invalid User"
        },
        {
          "name": "error_inactive_proxy",
          "label": "Error Inactive Proxy"
        },
        {
          "name": "error_unknown_source_route",
          "label": "Error Unknown Source Route"
        },
        {
          "name": "error_unknown_route",
          "label": "Error Unknown Route"
        },
        {
          "name": "error_internal",
          "label": "Error Internal"
        },
        {
          "name": "error_invalid_server",
          "label": "Error Invalid Server"
        },
        {
          "name": "error_invalid_scim_client",
          "label": "Error Invalid Scim Client"
        },
        {
          "name": "error_authentication_failed",
          "label": "Error Authentication Failed"
        }
      ]
    }
  },
  "response_type": "object",
  "response_title": "Policy Lookup Result Response",
  "response_description": "The policy details that include the web filter profile information for the policy lookup.",
  "complexity": "simple",
  "request_method": "GET",
  "request_fields": {
    "ipv6": {
      "name": "ipv6",
      "type": "boolean",
      "python_name": "ipv6",
      "summary": "Perform an IPv6 lookup?",
      "required": false,
      "pydantic_type": "bool",
      "python_type": "bool",
      "example": "2001:0db8:85a3:0000:0000:8a2e:0370:7334",
      "validation": {
        "pattern": "^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}$|^[0-9a-fA-F]{1,4}::(?:[0-9a-fA-F]{1,4}:){0,5}[0-9a-fA-F]{1,4}$"
      }
    },
    "srcintf": {
      "name": "srcintf",
      "type": "string",
      "python_name": "srcintf",
      "summary": "Source interface.",
      "required": true,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "sourceport": {
      "name": "sourceport",
      "type": "int",
      "python_name": "sourceport",
      "summary": "Source port.",
      "required": false,
      "pydantic_type": "int",
      "python_type": "int"
    },
    "sourceip": {
      "name": "sourceip",
      "type": "string",
      "python_name": "sourceip",
      "summary": "Source IP.",
      "required": true,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "protocol": {
      "name": "protocol",
      "type": "string",
      "python_name": "protocol",
      "summary": "Protocol.",
      "required": true,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "dest": {
      "name": "dest",
      "type": "string",
      "python_name": "dest",
      "summary": "Destination IP/FQDN.",
      "required": true,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "destport": {
      "name": "destport",
      "type": "int",
      "python_name": "destport",
      "summary": "Destination port.",
      "required": false,
      "pydantic_type": "int",
      "python_type": "int"
    },
    "icmptype": {
      "name": "icmptype",
      "type": "int",
      "python_name": "icmptype",
      "summary": "ICMP type.",
      "required": false,
      "pydantic_type": "int",
      "python_type": "int"
    },
    "icmpcode": {
      "name": "icmpcode",
      "type": "int",
      "python_name": "icmpcode",
      "summary": "ICMP code.",
      "required": false,
      "pydantic_type": "int",
      "python_type": "int"
    },
    "policy_type": {
      "name": "policy_type",
      "type": "string",
      "python_name": "policy_type",
      "summary": "Policy type. [*policy | proxy]",
      "required": false,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "auth_type": {
      "name": "auth_type",
      "type": "string",
      "python_name": "auth_type",
      "summary": "Authentication type. [user | group | saml | ldap] Note: this only works for models that can guarantee WAD workers availability, i.e. those that do not disable proxy features globally.",
      "required": false,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "user_group": {
      "name": "user_group",
      "type": "array",
      "python_name": "user_group",
      "summary": "List of remote user groups. ['cn=remote desktop users,cn=builtin,dc=devqa,dc=lab','cn=domain users,cn=users,dc=devqa,dc=lab', ...] Note: this only works for models that can guarantee WAD workers availability, i.e. those that do not disable proxy features globally.",
      "required": false,
      "pydantic_type": "List",
      "python_type": "List"
    },
    "server_name": {
      "name": "server_name",
      "type": "string",
      "python_name": "server_name",
      "summary": "Remote user/group server name. Note: this only works for models that can guarantee WAD workers availability, i.e. those that do not disable proxy features globally.",
      "required": false,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "user_db": {
      "name": "user_db",
      "type": "string",
      "python_name": "user_db",
      "summary": "Authentication server to contain user information.",
      "required": false,
      "pydantic_type": "str",
      "python_type": "str"
    },
    "group_attr_type": {
      "name": "group_attr_type",
      "type": "string",
      "python_name": "group_attr_type",
      "summary": "Remote user group attribute type. [*name | id]",
      "required": false,
      "pydantic_type": "str",
      "python_type": "str"
    }
  },
  "scope": "unknown",
  "capabilities": {
    "endpoint_type": "singleton",
    "crud": {
      "create": false,
      "read": true,
      "update": false,
      "delete": false
    },
    "actions": {
      "move": false,
      "clone": false
    },
    "features": {
      "filtering": false,
      "pagination": false,
      "search": false,
      "sorting": false,
      "format_options": false,
      "datasource": false,
      "schema_introspection": false,
      "vdom_scope": true,
      "member_tables": 0
    }
  }
}